{"componentChunkName":"component---src-templates-post-jsx","path":"/stringPool/","result":{"data":{"site":{"siteMetadata":{"title":"Dev.HJ"}},"markdownRemark":{"id":"9c040466-1d6f-5b3f-b1e2-b611a0920f53","excerpt":"String Constant Pool  의 두가지 생성 방식이 있고 각각의 차이점이 있다.  를 이용한 생성 방식 리터럴을 이용한 생성 방식 두 가지 방식의 큰 차이점은  연산자로 String 객체를 생성하면 Heap 영역에 객체를 저장하고, 리터럴로 String 객체를 생성하면 내부적으로 메소드가 호출되고 String Constant Pool 이라는 영…","html":"<h2>String Constant Pool</h2>\n<p><code class=\"language-text\">String</code> 의 두가지 생성 방식이 있고 각각의 차이점이 있다.</p>\n<ol>\n<li><code class=\"language-text\">new</code> 를 이용한 생성 방식</li>\n<li>리터럴을 이용한 생성 방식</li>\n</ol>\n<p>두 가지 방식의 큰 차이점은 <code class=\"language-text\">new</code> 연산자로 String 객체를 생성하면 Heap 영역에 객체를 저장하고, 리터럴로 String 객체를 생성하면 내부적으로 <code class=\"language-text\">String의 intern()</code>메소드가 호출되고 <strong>String Constant Pool</strong> 이라는 영역에 존재하게 된다. String Constant Pool 영역은 Heap 영역 내부에서 String 객체를 관리 위해 별도로 공간이 제공되고 있다. 이 공간에 문자열을 저장하고 사용하는 것을 <strong>String Interning</strong>이라고 한다.</p>\n<p>String Interning은 다음의 흐름으로 값을 찾는다.</p>\n<ol>\n<li>String 값이 String Constant Pool에 있는지 찾는다.</li>\n<li>있다면 그 문자열 객체의 주소 값을 반환한다.</li>\n<li>값이 없다면 String Constant Pool에 해당 값의 String 객체를 생성하고 주소 값을 반환한다.</li>\n</ol>\n<p>String Constant Pool을 이용하면 같은 값은 메모리에 추가 할당 없이 재사용이 가능하다는 장점을 가지고 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">StringPoolTest</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> s1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> s2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">String</span> s3 <span class=\"token operator\">=</span> s1<span class=\"token punctuation\">.</span><span class=\"token function\">intern</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> s4 <span class=\"token operator\">=</span> <span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> s5 <span class=\"token operator\">=</span> <span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"s1 :\"</span><span class=\"token operator\">+</span>s1<span class=\"token punctuation\">.</span><span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"s3 :\"</span><span class=\"token operator\">+</span>s3<span class=\"token punctuation\">.</span><span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"s4 :\"</span><span class=\"token operator\">+</span>s4<span class=\"token punctuation\">.</span><span class=\"token function\">hashCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"s1 :\"</span><span class=\"token operator\">+</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">identityHashCode</span><span class=\"token punctuation\">(</span>s1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"s2 :\"</span><span class=\"token operator\">+</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">identityHashCode</span><span class=\"token punctuation\">(</span>s2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"s3 :\"</span><span class=\"token operator\">+</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">identityHashCode</span><span class=\"token punctuation\">(</span>s3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"s4 :\"</span><span class=\"token operator\">+</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">identityHashCode</span><span class=\"token punctuation\">(</span>s4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"s5 :\"</span><span class=\"token operator\">+</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">identityHashCode</span><span class=\"token punctuation\">(</span>s5<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>s1<span class=\"token operator\">==</span>s2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>s3<span class=\"token operator\">==</span>s4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>s1<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>s3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>실행 결과</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/d1f83252479292950248dac20d424b26/b842e/result.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 45.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAsklEQVQoz6WR3QqFIBCEe6JSqJv+tYiktPd/mjnMQhKd4ITnYtBdh89xzZqmwTRNWNcVy7KgbVtRXdfo+x5d14Ee9riyT7F/eil6eZ6xsNZi33fM84w8z0VFUcT9vb6fXfsCZMIQApxzKMsSWutkCdAYA++9QIdhkJuezEop0bX+AnIWBPLJ27ahqqpH4+uEBI7jiOM4BHpNlwKOQH4Mk6aCIpAzI4jJfs3ndULq36ee+gA4SyM0W8o6iwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='result' title='result' src='/static/d1f83252479292950248dac20d424b26/ca1dc/result.png' srcset='/static/d1f83252479292950248dac20d424b26/e7570/result.png 170w,\n/static/d1f83252479292950248dac20d424b26/f46e7/result.png 340w,\n/static/d1f83252479292950248dac20d424b26/ca1dc/result.png 680w,\n/static/d1f83252479292950248dac20d424b26/02d09/result.png 1020w,\n/static/d1f83252479292950248dac20d424b26/b842e/result.png 1142w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>eqauls,==에 대한 포스팅은 <a href=\"https://hojoon7807.github.io/equals/\">eqauls와 ==의 차이</a> 포스팅을 보면 된다.</p>\n<p>실행 결과를 보면 new() 연산자로 생성된 객체 s1,s2는 같은 문자열값을 가지지만 주소값이 다른 것을 확인 할 수 있다. s3는 intern() 메소드를 사용하여 <code class=\"language-text\">\"hello\"</code>가 위에서 설명한 흐름을 통해 String Constant Pool 영역에 값이 생성된 것을 확인 할 수 있다. 그래서 s3, s4도 위의 결과를 가진다.\nhashCode()의 결과가 모두 같은 이유는 String에 오버라이딩된 코드를 보면 문자열의 값을 이용해 hash 값을 생성하기 때문에 그렇다.</p>\n<h2>Java 버전에 따른 String Constant Pool의 변화</h2>\n<h3>Java 6 이전</h3>\n<p>Java 6 이전에서는 String Constant Pool은 PermGen(Permenent Generation)영억에 있었다. 하지만 PermGen은 사이즈가 고정된 영역이었기 때문에 많은 String 데이터를 사용하면 OOM(Out Of Memory) 문제를 발생시킬수 있었다.</p>\n<h3>Java 7</h3>\n<p>Java 7 버전으로 올라오면서 String Constant Pool은 Heap 영역으로 위치가 옮겨졌다. 더 이상 고정된 크기의 메모리 영역에 제한을 받지 않게 됐다.\n또 String Constant Pool의 모든 문자열도 <strong>GC(Garbage Collection)</strong>의 대상이 된다.</p>\n<h2>StringTableSize</h2>\n<p>String Constant Pool은 기본적으로 해시테이블 구조를 가지고 있다. String을 해싱하고 그것을 키로 하여 값을 찾기 때문에 좋은 성능을 발휘할 수 있다. 해시테이블의 버킷 크기는 Java 버전 마다 차이가 있고 크기는 변경이 가능하다.</p>","frontmatter":{"title":"String Pool","date":"February 14, 2022","update":"February 14, 2022","tags":["java"],"series":null},"fields":{"slug":"/stringPool/","readingTime":{"minutes":3.835}}},"seriesList":{"edges":[{"node":{"id":"aeeabe20-f428-571f-a085-6cb528323517","fields":{"slug":"/jvm/"},"frontmatter":{"title":"Java Virtaul Machine"}}},{"node":{"id":"d322ca1f-aa27-5fc4-8ceb-7982c5738663","fields":{"slug":"/hashing/"},"frontmatter":{"title":"해싱이란?"}}},{"node":{"id":"85f7d472-c933-5918-9df5-33510bbd5c40","fields":{"slug":"/primitive-type/"},"frontmatter":{"title":"기본 타입(primitive type)"}}},{"node":{"id":"bbbb67ac-6c95-5684-b034-0f5e0ddc8ca1","fields":{"slug":"/equals/"},"frontmatter":{"title":"equals와 =="}}},{"node":{"id":"9c040466-1d6f-5b3f-b1e2-b611a0920f53","fields":{"slug":"/stringPool/"},"frontmatter":{"title":"String Pool"}}},{"node":{"id":"e9ec703f-3d62-523a-b7c7-f121c47bbf9f","fields":{"slug":"/string/"},"frontmatter":{"title":"문자열 중복 "}}},{"node":{"id":"c8e0cf33-615a-59be-bc1e-e26c406c927d","fields":{"slug":"/hashmap/"},"frontmatter":{"title":"HashMap"}}},{"node":{"id":"4e14a9fa-fa01-5cbc-9153-9bc68655ca17","fields":{"slug":"/generic/"},"frontmatter":{"title":"제너릭(Generic)"}}},{"node":{"id":"7c769d15-9003-56b7-9fc5-b1b960da36c0","fields":{"slug":"/process/"},"frontmatter":{"title":"[운영체제(OS)] 1.프로세스"}}},{"node":{"id":"4da2182b-2793-5418-a407-01f29fbbd757","fields":{"slug":"/map/"},"frontmatter":{"title":"HashMap, HashTable, ConcurrentHashMap"}}},{"node":{"id":"15a49153-8fff-5ab6-953e-5215b8e2faec","fields":{"slug":"/process2/"},"frontmatter":{"title":"[운영체제(OS)] 2.프로세스-IPC"}}},{"node":{"id":"0e33327d-d671-5b12-aa17-919f5b7107bd","fields":{"slug":"/thread/"},"frontmatter":{"title":"[운영체제(OS)] 3. 쓰레드(Thread)"}}},{"node":{"id":"794b97e8-63d4-5ed3-b203-d391651ec308","fields":{"slug":"/atomic/"},"frontmatter":{"title":"Java - Atomic"}}},{"node":{"id":"e7ea69fe-b48d-530a-9cb3-6cb7afeb7f67","fields":{"slug":"/adder-accumulator/"},"frontmatter":{"title":"Java - LongAdder와 LongAccumulator"}}},{"node":{"id":"678a2cb4-6b30-5113-9297-704160fe3a46","fields":{"slug":"/lambda/"},"frontmatter":{"title":"Java - 람다와 함수형 인터페이스"}}},{"node":{"id":"ea516931-cf7d-5fe6-a5e2-43145feed0e7","fields":{"slug":"/var/"},"frontmatter":{"title":"Java - var"}}},{"node":{"id":"03eac536-09bf-5d35-9903-1e5eff2c7123","fields":{"slug":"/fetch/"},"frontmatter":{"title":"JPA - 즉시로딩과 지연로딩"}}},{"node":{"id":"97f1315c-697a-52a2-ae72-77e3cb4869ec","fields":{"slug":"/content-type/"},"frontmatter":{"title":"[토이 프로젝트] - Content-Type - application/json"}}}]},"previous":{"fields":{"slug":"/equals/"},"frontmatter":{"title":"equals와 =="}},"next":{"fields":{"slug":"/string/"},"frontmatter":{"title":"문자열 중복 "}}},"pageContext":{"id":"9c040466-1d6f-5b3f-b1e2-b611a0920f53","series":null,"previousPostId":"bbbb67ac-6c95-5684-b034-0f5e0ddc8ca1","nextPostId":"e9ec703f-3d62-523a-b7c7-f121c47bbf9f"}},"staticQueryHashes":[]}